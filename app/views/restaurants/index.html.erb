
<div id="map"></div>
<script>
var infoWindow;

// 位置情報取得成功時
navigator.geolocation.getCurrentPosition(
    function (pos) {

        //現在地の緯度経度の取得
        var location ="<li>"+"緯度：" + pos.coords.latitude + "</li>";
        location += "<li>"+"経度：" + pos.coords.longitude + "</li>";
        lat = pos.coords.latitude;
        lng = pos.coords.longitude;

        //zoom,中心地の定義
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 16,
          center: {lat: lat, lng: lng}
        });

        //現在地の表示
        var you_are_here = new google.maps.Marker( {
            map: map ,  // 地図
            position: new google.maps.LatLng( lat, lng ) , // 位置座標
            icon: {
                url:'http://beachesbia.com/wp-content/uploads/2014/08/0011.png',
                scaledSize: new google.maps.Size( 50, 50 ) ,
            },
        } ) ;

        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.

        //DBの指定先の表示
        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            label: labels[i % labels.length]
          });
        });


        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});

        //吹き出し
        infoWindow = new google.maps.InfoWindow({ // 吹き出しの追加
        // content: '<div class="sample">YOU ARE HERE</div>' // 吹き出しに表示する内容
        content: '<a href="http://www.jreast.co.jp/estation/stations/1039.html" target="_blank">YOU ARE HERE</a>' // 吹き出しに表示する内容
        });
        you_are_here.addListener('click', function() { // マーカーをクリックしたとき
        infoWindow.open(map, you_are_here); // 吹き出しの表示
        });


        // //クリックしたら指定したurlに遷移するイベント
        // google.maps.event.addListener(you_are_here,'click', (function(url){
        //   return function(){ location.href = url; };
        // })(url));


    });



      var locations = [
        {lat: -31.563910, lng: 147.154312},
        {lat: -33.718234, lng: 150.363181},
        {lat: -33.727111, lng: 150.371124},
        {lat: -33.848588, lng: 151.209834},
        {lat: -33.851702, lng: 151.216968},
        {lat: -34.671264, lng: 150.863657},
        {lat: -35.304724, lng: 148.662905},
        {lat: -36.817685, lng: 175.699196},
        {lat: -36.828611, lng: 175.790222},
        {lat: -37.750000, lng: 145.116667},
        {lat: -37.759859, lng: 145.128708},
        {lat: -37.765015, lng: 145.133858},
        {lat: -37.770104, lng: 145.143299},
        {lat: -37.773700, lng: 145.145187},
        {lat: -37.774785, lng: 145.137978},
        {lat: -37.819616, lng: 144.968119},
        {lat: -38.330766, lng: 144.695692},
        {lat: -39.927193, lng: 175.053218},
        {lat: -41.330162, lng: 174.865694},
        {lat: -42.734358, lng: 147.439506},
        {lat: -42.734358, lng: 147.501315},
        {lat: -42.735258, lng: 147.438000},
        {lat: -43.999792, lng: 170.463352}
      ]
</script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP']%>&callback=initMap">
</script>